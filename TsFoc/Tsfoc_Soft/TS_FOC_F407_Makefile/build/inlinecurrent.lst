ARM GAS  /tmp/cc5E3Vyu.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"inlinecurrent.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "./underlying/src/inlinecurrent.c"
  20              		.global	__aeabi_f2d
  21              		.section	.rodata.DriftOffsets.str1.4,"aMS",%progbits,1
  22              		.align	2
  23              	.LC0:
  24 0000 6F666673 		.ascii	"offset_ia:%f\015\012\000"
  24      65745F69 
  24      613A2566 
  24      0D0A00
  25 000f 00       		.align	2
  26              	.LC1:
  27 0010 6F666673 		.ascii	"offset_ib:%f\015\012\000"
  27      65745F69 
  27      623A2566 
  27      0D0A00
  28 001f 00       		.align	2
  29              	.LC2:
  30 0020 6F666673 		.ascii	"offset_ic:%f\015\012\000"
  30      65745F69 
  30      633A2566 
  30      0D0A00
  31              		.section	.text.DriftOffsets,"ax",%progbits
  32              		.align	1
  33              		.global	DriftOffsets
  34              		.syntax unified
  35              		.thumb
  36              		.thumb_func
  38              	DriftOffsets:
  39              	.LVL0:
  40              	.LFB242:
   1:./underlying/src/inlinecurrent.c **** #include "inlinecurrent.h"
   2:./underlying/src/inlinecurrent.c **** 
   3:./underlying/src/inlinecurrent.c **** 
   4:./underlying/src/inlinecurrent.c **** 
   5:./underlying/src/inlinecurrent.c **** #define DEBUG_CURRENT
   6:./underlying/src/inlinecurrent.c **** 
   7:./underlying/src/inlinecurrent.c **** #ifdef DEBUG_CURRENT
   8:./underlying/src/inlinecurrent.c **** #include "stdio.h"
   9:./underlying/src/inlinecurrent.c **** #endif
ARM GAS  /tmp/cc5E3Vyu.s 			page 2


  10:./underlying/src/inlinecurrent.c **** 
  11:./underlying/src/inlinecurrent.c **** 
  12:./underlying/src/inlinecurrent.c **** uint16_t adc_dma_buffer[ADC_DMA_BUFFER_SIZE]; // 定义数组存储 DMA 传输后的 ADC 数据
  13:./underlying/src/inlinecurrent.c **** 
  14:./underlying/src/inlinecurrent.c **** 
  15:./underlying/src/inlinecurrent.c **** 
  16:./underlying/src/inlinecurrent.c **** 
  17:./underlying/src/inlinecurrent.c **** float _shunt_resistor = 0.01;
  18:./underlying/src/inlinecurrent.c **** float amp_gain = 50;
  19:./underlying/src/inlinecurrent.c **** float vlots_to_amps=0;
  20:./underlying/src/inlinecurrent.c **** 
  21:./underlying/src/inlinecurrent.c **** // /// @brief 零飘检测
  22:./underlying/src/inlinecurrent.c **** // /// @param Sensor 
  23:./underlying/src/inlinecurrent.c **** // void DriftOffsets(Inlinecurrent_Typedef *Sensor)
  24:./underlying/src/inlinecurrent.c **** // {
  25:./underlying/src/inlinecurrent.c **** // 	uint16_t detect_rounds = 1000;
  26:./underlying/src/inlinecurrent.c **** // 	for(int i = 0; i < detect_rounds; i++)
  27:./underlying/src/inlinecurrent.c **** // 	{
  28:./underlying/src/inlinecurrent.c **** // 		Sensor->offset_ia += adc_dma_buffer[Sensor->A]*_ADC_CONV;
  29:./underlying/src/inlinecurrent.c **** // 		Sensor->offset_ib += adc_dma_buffer[Sensor->B]*_ADC_CONV;
  30:./underlying/src/inlinecurrent.c **** // 	}
  31:./underlying/src/inlinecurrent.c **** // 	Sensor->offset_ia = Sensor->offset_ia / detect_rounds;
  32:./underlying/src/inlinecurrent.c **** // 	Sensor->offset_ib = Sensor->offset_ib / detect_rounds;
  33:./underlying/src/inlinecurrent.c **** // }
  34:./underlying/src/inlinecurrent.c **** /// @brief 零飘检测
  35:./underlying/src/inlinecurrent.c **** /// @param Sensor 
  36:./underlying/src/inlinecurrent.c **** void DriftOffsets(Inlinecurrent_Typedef *Sensor)
  37:./underlying/src/inlinecurrent.c **** {
  41              		.loc 1 37 1 view -0
  42              		.cfi_startproc
  43              		@ args = 0, pretend = 0, frame = 0
  44              		@ frame_needed = 0, uses_anonymous_args = 0
  45              		.loc 1 37 1 is_stmt 0 view .LVU1
  46 0000 10B5     		push	{r4, lr}
  47              	.LCFI0:
  48              		.cfi_def_cfa_offset 8
  49              		.cfi_offset 4, -8
  50              		.cfi_offset 14, -4
  51 0002 0446     		mov	r4, r0
  38:./underlying/src/inlinecurrent.c ****     uint16_t detect_rounds = 1000;
  52              		.loc 1 38 5 is_stmt 1 view .LVU2
  53              	.LVL1:
  39:./underlying/src/inlinecurrent.c ****     // 初始化偏移量为0
  40:./underlying/src/inlinecurrent.c ****     Sensor->offset_ia = 0;
  54              		.loc 1 40 5 view .LVU3
  55              		.loc 1 40 23 is_stmt 0 view .LVU4
  56 0004 0023     		movs	r3, #0
  57 0006 8361     		str	r3, [r0, #24]	@ float
  41:./underlying/src/inlinecurrent.c ****     Sensor->offset_ib = 0;
  58              		.loc 1 41 5 is_stmt 1 view .LVU5
  59              		.loc 1 41 23 is_stmt 0 view .LVU6
  60 0008 C361     		str	r3, [r0, #28]	@ float
  42:./underlying/src/inlinecurrent.c ****     Sensor->offset_ic = 0; // 如果适用
  61              		.loc 1 42 5 is_stmt 1 view .LVU7
  62              		.loc 1 42 23 is_stmt 0 view .LVU8
  63 000a 0362     		str	r3, [r0, #32]	@ float
  43:./underlying/src/inlinecurrent.c ****     for(int i = 0; i < detect_rounds; i++)
ARM GAS  /tmp/cc5E3Vyu.s 			page 3


  64              		.loc 1 43 5 is_stmt 1 view .LVU9
  65              	.LBB2:
  66              		.loc 1 43 9 view .LVU10
  67              	.LVL2:
  68              		.loc 1 43 13 is_stmt 0 view .LVU11
  69 000c 0022     		movs	r2, #0
  70              		.loc 1 43 5 view .LVU12
  71 000e 30E0     		b	.L2
  72              	.LVL3:
  73              	.L3:
  44:./underlying/src/inlinecurrent.c ****     {
  45:./underlying/src/inlinecurrent.c ****         Sensor->offset_ia += adc_dma_buffer[Sensor->A]*_ADC_CONV;
  74              		.loc 1 45 9 is_stmt 1 view .LVU13
  75              		.loc 1 45 51 is_stmt 0 view .LVU14
  76 0010 2168     		ldr	r1, [r4]
  77              		.loc 1 45 44 view .LVU15
  78 0012 304B     		ldr	r3, .L5
  79 0014 33F81110 		ldrh	r1, [r3, r1, lsl #1]
  80 0018 07EE901A 		vmov	s15, r1	@ int
  81              		.loc 1 45 55 view .LVU16
  82 001c F8EEE77A 		vcvt.f32.s32	s15, s15
  83 0020 9FED2D7A 		vldr.32	s14, .L5+4
  84 0024 67EE877A 		vmul.f32	s15, s15, s14
  85              		.loc 1 45 15 view .LVU17
  86 0028 D4ED066A 		vldr.32	s13, [r4, #24]
  87              		.loc 1 45 27 view .LVU18
  88 002c 76EEA77A 		vadd.f32	s15, s13, s15
  89 0030 C4ED067A 		vstr.32	s15, [r4, #24]
  46:./underlying/src/inlinecurrent.c ****         Sensor->offset_ib += adc_dma_buffer[Sensor->B]*_ADC_CONV;
  90              		.loc 1 46 9 is_stmt 1 view .LVU19
  91              		.loc 1 46 51 is_stmt 0 view .LVU20
  92 0034 6168     		ldr	r1, [r4, #4]
  93              		.loc 1 46 44 view .LVU21
  94 0036 33F81110 		ldrh	r1, [r3, r1, lsl #1]
  95 003a 07EE901A 		vmov	s15, r1	@ int
  96              		.loc 1 46 55 view .LVU22
  97 003e F8EEE77A 		vcvt.f32.s32	s15, s15
  98 0042 67EE877A 		vmul.f32	s15, s15, s14
  99              		.loc 1 46 15 view .LVU23
 100 0046 D4ED076A 		vldr.32	s13, [r4, #28]
 101              		.loc 1 46 27 view .LVU24
 102 004a 76EEA77A 		vadd.f32	s15, s13, s15
 103 004e C4ED077A 		vstr.32	s15, [r4, #28]
  47:./underlying/src/inlinecurrent.c ****         Sensor->offset_ic += adc_dma_buffer[Sensor->C]*_ADC_CONV; // 如果适用
 104              		.loc 1 47 9 is_stmt 1 view .LVU25
 105              		.loc 1 47 51 is_stmt 0 view .LVU26
 106 0052 A168     		ldr	r1, [r4, #8]
 107              		.loc 1 47 44 view .LVU27
 108 0054 33F81130 		ldrh	r3, [r3, r1, lsl #1]
 109 0058 07EE903A 		vmov	s15, r3	@ int
 110              		.loc 1 47 55 view .LVU28
 111 005c F8EEE77A 		vcvt.f32.s32	s15, s15
 112 0060 67EE877A 		vmul.f32	s15, s15, s14
 113              		.loc 1 47 15 view .LVU29
 114 0064 94ED087A 		vldr.32	s14, [r4, #32]
 115              		.loc 1 47 27 view .LVU30
 116 0068 77EE277A 		vadd.f32	s15, s14, s15
ARM GAS  /tmp/cc5E3Vyu.s 			page 4


 117 006c C4ED087A 		vstr.32	s15, [r4, #32]
  43:./underlying/src/inlinecurrent.c ****     {
 118              		.loc 1 43 40 is_stmt 1 discriminator 3 view .LVU31
 119 0070 0132     		adds	r2, r2, #1
 120              	.LVL4:
 121              	.L2:
  43:./underlying/src/inlinecurrent.c ****     {
 122              		.loc 1 43 22 discriminator 1 view .LVU32
 123 0072 B2F57A7F 		cmp	r2, #1000
 124 0076 CBDB     		blt	.L3
 125              	.LBE2:
  48:./underlying/src/inlinecurrent.c ****     }
  49:./underlying/src/inlinecurrent.c ****     Sensor->offset_ia /= detect_rounds;
 126              		.loc 1 49 5 view .LVU33
 127              		.loc 1 49 11 is_stmt 0 view .LVU34
 128 0078 D4ED066A 		vldr.32	s13, [r4, #24]
 129              		.loc 1 49 23 view .LVU35
 130 007c DFED177A 		vldr.32	s15, .L5+8
 131 0080 86EEA77A 		vdiv.f32	s14, s13, s15
 132 0084 84ED067A 		vstr.32	s14, [r4, #24]
  50:./underlying/src/inlinecurrent.c ****     Sensor->offset_ib /= detect_rounds;
 133              		.loc 1 50 5 is_stmt 1 view .LVU36
 134              		.loc 1 50 11 is_stmt 0 view .LVU37
 135 0088 D4ED076A 		vldr.32	s13, [r4, #28]
 136              		.loc 1 50 23 view .LVU38
 137 008c 86EEA77A 		vdiv.f32	s14, s13, s15
 138 0090 84ED077A 		vstr.32	s14, [r4, #28]
  51:./underlying/src/inlinecurrent.c ****     Sensor->offset_ic /= detect_rounds; // 如果适用
 139              		.loc 1 51 5 is_stmt 1 view .LVU39
 140              		.loc 1 51 11 is_stmt 0 view .LVU40
 141 0094 D4ED086A 		vldr.32	s13, [r4, #32]
 142              		.loc 1 51 23 view .LVU41
 143 0098 86EEA77A 		vdiv.f32	s14, s13, s15
 144 009c 84ED087A 		vstr.32	s14, [r4, #32]
  52:./underlying/src/inlinecurrent.c ****     printf("offset_ia:%f\r\n",Sensor->offset_ia);
 145              		.loc 1 52 5 is_stmt 1 view .LVU42
 146              		.loc 1 52 37 is_stmt 0 view .LVU43
 147 00a0 A069     		ldr	r0, [r4, #24]	@ float
 148              	.LVL5:
 149              		.loc 1 52 5 view .LVU44
 150 00a2 FFF7FEFF 		bl	__aeabi_f2d
 151              	.LVL6:
 152              		.loc 1 52 5 view .LVU45
 153 00a6 0246     		mov	r2, r0
 154 00a8 0B46     		mov	r3, r1
 155 00aa 0D48     		ldr	r0, .L5+12
 156 00ac FFF7FEFF 		bl	printf
 157              	.LVL7:
  53:./underlying/src/inlinecurrent.c ****     printf("offset_ib:%f\r\n",Sensor->offset_ib);
 158              		.loc 1 53 5 is_stmt 1 view .LVU46
 159              		.loc 1 53 37 is_stmt 0 view .LVU47
 160 00b0 E069     		ldr	r0, [r4, #28]	@ float
 161              		.loc 1 53 5 view .LVU48
 162 00b2 FFF7FEFF 		bl	__aeabi_f2d
 163              	.LVL8:
 164 00b6 0246     		mov	r2, r0
 165 00b8 0B46     		mov	r3, r1
ARM GAS  /tmp/cc5E3Vyu.s 			page 5


 166 00ba 0A48     		ldr	r0, .L5+16
 167 00bc FFF7FEFF 		bl	printf
 168              	.LVL9:
  54:./underlying/src/inlinecurrent.c ****     printf("offset_ic:%f\r\n",Sensor->offset_ic); // 如果适用
 169              		.loc 1 54 5 is_stmt 1 view .LVU49
 170              		.loc 1 54 37 is_stmt 0 view .LVU50
 171 00c0 206A     		ldr	r0, [r4, #32]	@ float
 172              		.loc 1 54 5 view .LVU51
 173 00c2 FFF7FEFF 		bl	__aeabi_f2d
 174              	.LVL10:
 175 00c6 0246     		mov	r2, r0
 176 00c8 0B46     		mov	r3, r1
 177 00ca 0748     		ldr	r0, .L5+20
 178 00cc FFF7FEFF 		bl	printf
 179              	.LVL11:
  55:./underlying/src/inlinecurrent.c **** }
 180              		.loc 1 55 1 view .LVU52
 181 00d0 10BD     		pop	{r4, pc}
 182              	.LVL12:
 183              	.L6:
 184              		.loc 1 55 1 view .LVU53
 185 00d2 00BF     		.align	2
 186              	.L5:
 187 00d4 00000000 		.word	adc_dma_buffer
 188 00d8 5940533A 		.word	978534489
 189 00dc 00007A44 		.word	1148846080
 190 00e0 00000000 		.word	.LC0
 191 00e4 10000000 		.word	.LC1
 192 00e8 20000000 		.word	.LC2
 193              		.cfi_endproc
 194              	.LFE242:
 196              		.section	.rodata.CurrSense_Init.str1.4,"aMS",%progbits,1
 197              		.align	2
 198              	.LC3:
 199 0000 43757272 		.ascii	"CurrSense_Init success\015\000"
 199      53656E73 
 199      655F496E 
 199      69742073 
 199      75636365 
 200              		.section	.text.CurrSense_Init,"ax",%progbits
 201              		.align	1
 202              		.global	CurrSense_Init
 203              		.syntax unified
 204              		.thumb
 205              		.thumb_func
 207              	CurrSense_Init:
 208              	.LVL13:
 209              	.LFB243:
  56:./underlying/src/inlinecurrent.c **** // /// @brief 初始化电流传感器
  57:./underlying/src/inlinecurrent.c **** // /// @param Sensor 
  58:./underlying/src/inlinecurrent.c **** // void CurrSense_Init(Inlinecurrent_Typedef *Sensor)
  59:./underlying/src/inlinecurrent.c **** // {
  60:./underlying/src/inlinecurrent.c **** // 	DriftOffsets(Sensor);
  61:./underlying/src/inlinecurrent.c **** // 	_shunt_resistor = 0.01; 
  62:./underlying/src/inlinecurrent.c **** // 	amp_gain = 50; 
  63:./underlying/src/inlinecurrent.c **** // 	vlots_to_amps = 1.0f / _shunt_resistor / amp_gain;
  64:./underlying/src/inlinecurrent.c **** // 	Sensor->gain_a = vlots_to_amps * -1;
ARM GAS  /tmp/cc5E3Vyu.s 			page 6


  65:./underlying/src/inlinecurrent.c **** // 	Sensor->gain_b = vlots_to_amps * -1;
  66:./underlying/src/inlinecurrent.c **** // 	Sensor->gain_c = vlots_to_amps;
  67:./underlying/src/inlinecurrent.c **** // }
  68:./underlying/src/inlinecurrent.c **** /// @brief 初始化电流传感器
  69:./underlying/src/inlinecurrent.c **** /// @param Sensor 
  70:./underlying/src/inlinecurrent.c **** int CurrSense_Init(Inlinecurrent_Typedef *Sensor,int A,int B,int C,ADC_HandleTypeDef *hadc)
  71:./underlying/src/inlinecurrent.c **** {
 210              		.loc 1 71 1 is_stmt 1 view -0
 211              		.cfi_startproc
 212              		@ args = 4, pretend = 0, frame = 0
 213              		@ frame_needed = 0, uses_anonymous_args = 0
 214              		.loc 1 71 1 is_stmt 0 view .LVU55
 215 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 216              	.LCFI1:
 217              		.cfi_def_cfa_offset 24
 218              		.cfi_offset 3, -24
 219              		.cfi_offset 4, -20
 220              		.cfi_offset 5, -16
 221              		.cfi_offset 6, -12
 222              		.cfi_offset 7, -8
 223              		.cfi_offset 14, -4
 224 0002 0446     		mov	r4, r0
 225 0004 0F46     		mov	r7, r1
 226 0006 1646     		mov	r6, r2
 227 0008 1D46     		mov	r5, r3
  72:./underlying/src/inlinecurrent.c ****     HAL_ADC_Start_DMA(hadc, (uint32_t*)adc_dma_buffer, ADC_DMA_BUFFER_SIZE); // 启动 DMA 传输
 228              		.loc 1 72 5 is_stmt 1 view .LVU56
 229 000a 0622     		movs	r2, #6
 230              	.LVL14:
 231              		.loc 1 72 5 is_stmt 0 view .LVU57
 232 000c 0A49     		ldr	r1, .L9
 233              	.LVL15:
 234              		.loc 1 72 5 view .LVU58
 235 000e 0698     		ldr	r0, [sp, #24]
 236              	.LVL16:
 237              		.loc 1 72 5 view .LVU59
 238 0010 FFF7FEFF 		bl	HAL_ADC_Start_DMA
 239              	.LVL17:
  73:./underlying/src/inlinecurrent.c **** 
  74:./underlying/src/inlinecurrent.c ****     Sensor->A = A;
 240              		.loc 1 74 5 is_stmt 1 view .LVU60
 241              		.loc 1 74 15 is_stmt 0 view .LVU61
 242 0014 2760     		str	r7, [r4]
  75:./underlying/src/inlinecurrent.c ****     Sensor->B = B;
 243              		.loc 1 75 5 is_stmt 1 view .LVU62
 244              		.loc 1 75 15 is_stmt 0 view .LVU63
 245 0016 6660     		str	r6, [r4, #4]
  76:./underlying/src/inlinecurrent.c ****     Sensor->C = C; // 如果适用
 246              		.loc 1 76 5 is_stmt 1 view .LVU64
 247              		.loc 1 76 15 is_stmt 0 view .LVU65
 248 0018 A560     		str	r5, [r4, #8]
  77:./underlying/src/inlinecurrent.c ****     DriftOffsets(Sensor);
 249              		.loc 1 77 5 is_stmt 1 view .LVU66
 250 001a 2046     		mov	r0, r4
 251 001c FFF7FEFF 		bl	DriftOffsets
 252              	.LVL18:
  78:./underlying/src/inlinecurrent.c ****     
ARM GAS  /tmp/cc5E3Vyu.s 			page 7


  79:./underlying/src/inlinecurrent.c ****     float _shunt_resistor = 0.01f; 
 253              		.loc 1 79 5 view .LVU67
  80:./underlying/src/inlinecurrent.c ****     float amp_gain = 50.0f; 
 254              		.loc 1 80 5 view .LVU68
  81:./underlying/src/inlinecurrent.c ****     
  82:./underlying/src/inlinecurrent.c ****     float vlots_to_amps = 1.0f / _shunt_resistor / amp_gain;
 255              		.loc 1 82 5 view .LVU69
  83:./underlying/src/inlinecurrent.c ****     
  84:./underlying/src/inlinecurrent.c ****     // 所有的增益系数都应该相同，除非有特殊原因
  85:./underlying/src/inlinecurrent.c ****     Sensor->gain_a = vlots_to_amps*-1;
 256              		.loc 1 85 5 view .LVU70
 257              		.loc 1 85 20 is_stmt 0 view .LVU71
 258 0020 4FF04043 		mov	r3, #-1073741824
 259 0024 6362     		str	r3, [r4, #36]	@ float
  86:./underlying/src/inlinecurrent.c ****     Sensor->gain_b = vlots_to_amps*-1;
 260              		.loc 1 86 5 is_stmt 1 view .LVU72
 261              		.loc 1 86 20 is_stmt 0 view .LVU73
 262 0026 A362     		str	r3, [r4, #40]	@ float
  87:./underlying/src/inlinecurrent.c ****     Sensor->gain_c = vlots_to_amps;
 263              		.loc 1 87 5 is_stmt 1 view .LVU74
 264              		.loc 1 87 20 is_stmt 0 view .LVU75
 265 0028 4FF08043 		mov	r3, #1073741824
 266 002c E362     		str	r3, [r4, #44]	@ float
  88:./underlying/src/inlinecurrent.c ****     printf("CurrSense_Init success\r\n");
 267              		.loc 1 88 5 is_stmt 1 view .LVU76
 268 002e 0348     		ldr	r0, .L9+4
 269 0030 FFF7FEFF 		bl	puts
 270              	.LVL19:
  89:./underlying/src/inlinecurrent.c ****     return 0;
 271              		.loc 1 89 5 view .LVU77
  90:./underlying/src/inlinecurrent.c **** }
 272              		.loc 1 90 1 is_stmt 0 view .LVU78
 273 0034 0020     		movs	r0, #0
 274 0036 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 275              	.LVL20:
 276              	.L10:
 277              		.loc 1 90 1 view .LVU79
 278              		.align	2
 279              	.L9:
 280 0038 00000000 		.word	adc_dma_buffer
 281 003c 00000000 		.word	.LC3
 282              		.cfi_endproc
 283              	.LFE243:
 285              		.section	.text.Current_Update,"ax",%progbits
 286              		.align	1
 287              		.global	Current_Update
 288              		.syntax unified
 289              		.thumb
 290              		.thumb_func
 292              	Current_Update:
 293              	.LVL21:
 294              	.LFB244:
  91:./underlying/src/inlinecurrent.c **** /// @brief 更新电流数值
  92:./underlying/src/inlinecurrent.c **** /// @param Sensor 
  93:./underlying/src/inlinecurrent.c **** void Current_Update(Inlinecurrent_Typedef *Sensor)
  94:./underlying/src/inlinecurrent.c **** {
 295              		.loc 1 94 1 is_stmt 1 view -0
ARM GAS  /tmp/cc5E3Vyu.s 			page 8


 296              		.cfi_startproc
 297              		@ args = 0, pretend = 0, frame = 0
 298              		@ frame_needed = 0, uses_anonymous_args = 0
 299              		@ link register save eliminated.
  95:./underlying/src/inlinecurrent.c **** 	float tran_vol_a = (float)adc_dma_buffer[Sensor->A]*_ADC_CONV;
 300              		.loc 1 95 2 view .LVU81
 301              		.loc 1 95 49 is_stmt 0 view .LVU82
 302 0000 0268     		ldr	r2, [r0]
 303              		.loc 1 95 42 view .LVU83
 304 0002 1E4B     		ldr	r3, .L12
 305 0004 33F81220 		ldrh	r2, [r3, r2, lsl #1]
 306 0008 06EE902A 		vmov	s13, r2	@ int
 307              		.loc 1 95 21 view .LVU84
 308 000c F8EE666A 		vcvt.f32.u32	s13, s13
 309              		.loc 1 95 8 view .LVU85
 310 0010 9FED1B6A 		vldr.32	s12, .L12+4
 311 0014 66EE866A 		vmul.f32	s13, s13, s12
 312              	.LVL22:
  96:./underlying/src/inlinecurrent.c **** 	float tran_vol_b = (float)adc_dma_buffer[Sensor->B]*_ADC_CONV;
 313              		.loc 1 96 2 is_stmt 1 view .LVU86
 314              		.loc 1 96 49 is_stmt 0 view .LVU87
 315 0018 4268     		ldr	r2, [r0, #4]
 316              		.loc 1 96 42 view .LVU88
 317 001a 33F81220 		ldrh	r2, [r3, r2, lsl #1]
 318 001e 07EE102A 		vmov	s14, r2	@ int
 319              		.loc 1 96 21 view .LVU89
 320 0022 B8EE477A 		vcvt.f32.u32	s14, s14
 321              		.loc 1 96 8 view .LVU90
 322 0026 27EE067A 		vmul.f32	s14, s14, s12
 323              	.LVL23:
  97:./underlying/src/inlinecurrent.c ****     float tran_vol_c = (float)adc_dma_buffer[Sensor->C]*_ADC_CONV; // 如果适用
 324              		.loc 1 97 5 is_stmt 1 view .LVU91
 325              		.loc 1 97 52 is_stmt 0 view .LVU92
 326 002a 8268     		ldr	r2, [r0, #8]
 327              		.loc 1 97 45 view .LVU93
 328 002c 33F81230 		ldrh	r3, [r3, r2, lsl #1]
 329 0030 07EE903A 		vmov	s15, r3	@ int
 330              		.loc 1 97 24 view .LVU94
 331 0034 F8EE677A 		vcvt.f32.u32	s15, s15
 332              		.loc 1 97 11 view .LVU95
 333 0038 67EE867A 		vmul.f32	s15, s15, s12
 334              	.LVL24:
  98:./underlying/src/inlinecurrent.c **** // #ifdef DEBUG_CURRENT
  99:./underlying/src/inlinecurrent.c **** //     printf("%f,",tran_vol_a);
 100:./underlying/src/inlinecurrent.c **** // 	printf("%f,",tran_vol_b);
 101:./underlying/src/inlinecurrent.c **** // 	printf("%f\r\n",tran_vol_c);
 102:./underlying/src/inlinecurrent.c **** // #endif
 103:./underlying/src/inlinecurrent.c **** 	Sensor->I_a = (tran_vol_a - Sensor->offset_ia)*Sensor->gain_a;
 335              		.loc 1 103 2 is_stmt 1 view .LVU96
 336              		.loc 1 103 36 is_stmt 0 view .LVU97
 337 003c 90ED066A 		vldr.32	s12, [r0, #24]
 338              		.loc 1 103 28 view .LVU98
 339 0040 76EEC66A 		vsub.f32	s13, s13, s12
 340              	.LVL25:
 341              		.loc 1 103 55 view .LVU99
 342 0044 90ED096A 		vldr.32	s12, [r0, #36]
 343              		.loc 1 103 48 view .LVU100
ARM GAS  /tmp/cc5E3Vyu.s 			page 9


 344 0048 66EE866A 		vmul.f32	s13, s13, s12
 345              		.loc 1 103 14 view .LVU101
 346 004c C0ED036A 		vstr.32	s13, [r0, #12]
 104:./underlying/src/inlinecurrent.c **** 	Sensor->I_b = (tran_vol_b - Sensor->offset_ib)*Sensor->gain_b;
 347              		.loc 1 104 2 is_stmt 1 view .LVU102
 348              		.loc 1 104 36 is_stmt 0 view .LVU103
 349 0050 D0ED076A 		vldr.32	s13, [r0, #28]
 350              		.loc 1 104 28 view .LVU104
 351 0054 37EE667A 		vsub.f32	s14, s14, s13
 352              	.LVL26:
 353              		.loc 1 104 55 view .LVU105
 354 0058 D0ED0A6A 		vldr.32	s13, [r0, #40]
 355              		.loc 1 104 48 view .LVU106
 356 005c 27EE267A 		vmul.f32	s14, s14, s13
 357              		.loc 1 104 14 view .LVU107
 358 0060 80ED047A 		vstr.32	s14, [r0, #16]
 105:./underlying/src/inlinecurrent.c ****     Sensor->I_c = (tran_vol_c - Sensor->offset_ic)*Sensor->gain_c; // 如果适用
 359              		.loc 1 105 5 is_stmt 1 view .LVU108
 360              		.loc 1 105 39 is_stmt 0 view .LVU109
 361 0064 90ED087A 		vldr.32	s14, [r0, #32]
 362              		.loc 1 105 31 view .LVU110
 363 0068 77EEC77A 		vsub.f32	s15, s15, s14
 364              	.LVL27:
 365              		.loc 1 105 58 view .LVU111
 366 006c 90ED0B7A 		vldr.32	s14, [r0, #44]
 367              		.loc 1 105 51 view .LVU112
 368 0070 67EE877A 		vmul.f32	s15, s15, s14
 369              		.loc 1 105 17 view .LVU113
 370 0074 C0ED057A 		vstr.32	s15, [r0, #20]
 106:./underlying/src/inlinecurrent.c **** }
 371              		.loc 1 106 1 view .LVU114
 372 0078 7047     		bx	lr
 373              	.L13:
 374 007a 00BF     		.align	2
 375              	.L12:
 376 007c 00000000 		.word	adc_dma_buffer
 377 0080 5940533A 		.word	978534489
 378              		.cfi_endproc
 379              	.LFE244:
 381              		.global	vlots_to_amps
 382              		.section	.bss.vlots_to_amps,"aw",%nobits
 383              		.align	2
 386              	vlots_to_amps:
 387 0000 00000000 		.space	4
 388              		.global	amp_gain
 389              		.section	.data.amp_gain,"aw"
 390              		.align	2
 393              	amp_gain:
 394 0000 00004842 		.word	1112014848
 395              		.global	_shunt_resistor
 396              		.section	.data._shunt_resistor,"aw"
 397              		.align	2
 400              	_shunt_resistor:
 401 0000 0AD7233C 		.word	1008981770
 402              		.global	adc_dma_buffer
 403              		.section	.bss.adc_dma_buffer,"aw",%nobits
 404              		.align	2
ARM GAS  /tmp/cc5E3Vyu.s 			page 10


 407              	adc_dma_buffer:
 408 0000 00000000 		.space	12
 408      00000000 
 408      00000000 
 409              		.text
 410              	.Letext0:
 411              		.file 2 "/usr/lib/gcc/arm-none-eabi/13.2.1/include/stdint.h"
 412              		.file 3 "./Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f407xx.h"
 413              		.file 4 "./Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 414              		.file 5 "./Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 415              		.file 6 "./Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 416              		.file 7 "./Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_adc.h"
 417              		.file 8 "./underlying/inc/inlinecurrent.h"
 418              		.file 9 "/usr/include/newlib/stdio.h"
 419              		.file 10 "<built-in>"
ARM GAS  /tmp/cc5E3Vyu.s 			page 11


DEFINED SYMBOLS
                            *ABS*:00000000 inlinecurrent.c
     /tmp/cc5E3Vyu.s:22     .rodata.DriftOffsets.str1.4:00000000 $d
     /tmp/cc5E3Vyu.s:32     .text.DriftOffsets:00000000 $t
     /tmp/cc5E3Vyu.s:38     .text.DriftOffsets:00000000 DriftOffsets
     /tmp/cc5E3Vyu.s:187    .text.DriftOffsets:000000d4 $d
     /tmp/cc5E3Vyu.s:407    .bss.adc_dma_buffer:00000000 adc_dma_buffer
     /tmp/cc5E3Vyu.s:197    .rodata.CurrSense_Init.str1.4:00000000 $d
     /tmp/cc5E3Vyu.s:201    .text.CurrSense_Init:00000000 $t
     /tmp/cc5E3Vyu.s:207    .text.CurrSense_Init:00000000 CurrSense_Init
     /tmp/cc5E3Vyu.s:280    .text.CurrSense_Init:00000038 $d
     /tmp/cc5E3Vyu.s:286    .text.Current_Update:00000000 $t
     /tmp/cc5E3Vyu.s:292    .text.Current_Update:00000000 Current_Update
     /tmp/cc5E3Vyu.s:376    .text.Current_Update:0000007c $d
     /tmp/cc5E3Vyu.s:386    .bss.vlots_to_amps:00000000 vlots_to_amps
     /tmp/cc5E3Vyu.s:383    .bss.vlots_to_amps:00000000 $d
     /tmp/cc5E3Vyu.s:393    .data.amp_gain:00000000 amp_gain
     /tmp/cc5E3Vyu.s:390    .data.amp_gain:00000000 $d
     /tmp/cc5E3Vyu.s:400    .data._shunt_resistor:00000000 _shunt_resistor
     /tmp/cc5E3Vyu.s:397    .data._shunt_resistor:00000000 $d
     /tmp/cc5E3Vyu.s:404    .bss.adc_dma_buffer:00000000 $d

UNDEFINED SYMBOLS
__aeabi_f2d
printf
HAL_ADC_Start_DMA
puts
